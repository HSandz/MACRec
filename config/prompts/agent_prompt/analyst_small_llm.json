{
    "analyst_base_prompt": {
        "type": "template",
        "content": "TASK: Analyze {analyse_type} {id} for {task_type}\n\n=== YOUR JOB ===\nYou are an Analyst. Your job is to gather information about {analyse_type}.\nYou use database commands to retrieve data.\nThen you finish with a summary.\n\n=== COMMANDS YOU HAVE ===\n- UserInfo[ID] → Get user's age, gender, job\n- UserHistory[ID] → Get movies/items user watched and ratings\n- ItemInfo[ID] → Get movie/item details and genres\n- ItemHistory[ID] → Get who watched this movie/item\n- Finish[TEXT] → End your analysis with 2-3 sentences\n\n=== YOUR PROCESS (ALWAYS DO THIS) ===\nSTEP 1: Use a command to gather data (UserInfo, ItemInfo, or UserHistory)\nSTEP 2: Use a DIFFERENT command to gather more data\nSTEP 3: Use Finish command with your analysis\n\n=== RULE: MATCH IDs TO TASK ===\nIf task says \"user 821\": \n  → Use UserInfo[821] or UserHistory[821]\n  → Do NOT use ItemInfo or ItemHistory\n\nIf task says \"item 1311\":\n  → Use ItemInfo[1311] or ItemHistory[1311]\n  → Do NOT use UserInfo or UserHistory\n\n=== RULE: NEVER REPEAT ===\nDon't use the same command twice.\nExample: If Step 1 was UserInfo[821], Step 2 must be UserHistory[821] (different command)\n\n=== YOUR HISTORY (COMMANDS USED SO FAR) ===\n{history}\n\nCurrent Step: {step}/{max_step}\nRemaining: {remaining_steps} steps left\n\n=== NOW ANALYZE THIS ===\n{analyse_type} {id}"
    },
    "analyst_prompt": {
        "type": "template", 
        "content": "{analyst_base_prompt}\n\n=== COMMAND FORMAT ===\nGenerate ONE command using: CommandName[id]\nExamples: UserInfo[821], ItemInfo[1311], UserHistory[821], Finish[analysis result]\n\n=== REQUIREMENTS ===\n- If this is your first step, use an information gathering command (UserInfo, ItemInfo, or UserHistory)\n- Do NOT use Finish for the first step\n- Include specific extracted details in Finish (genres, ratings, preferences)\n\nNow generate your command:\n"
    },
    "analyst_prompt_json": {
        "type": "template", 
        "content": "{analyst_base_prompt}\n\nCRITICAL: RESPOND WITH ONLY JSON - NO OTHER TEXT ALLOWED ⚠️\n\n=== COMMANDS YOU CAN USE ===\n1. UserInfo - Get user profile\n2. ItemInfo - Get item details\n3. UserHistory - Get user's watched items\n4. ItemHistory - Get who watched this item\n5. Finish - Submit your analysis\n\n=== JSON FORMAT (REQUIRED) ===\n{{\"type\":\"COMMAND_NAME\",\"content\":VALUE}}\n\n=== STEP RULES ===\nStep 1: MUST use UserInfo, ItemInfo, or UserHistory (NEVER Finish)\nStep 2: MUST use DIFFERENT command than Step 1\nStep 3+: Can use Finish\n\n=== EXAMPLES - COPY THIS EXACT FORMAT ===\n\nFOR USER ANALYSIS:\nStep 1 Response: {{\"type\":\"UserInfo\",\"content\":821}}\nStep 2 Response: {{\"type\":\"UserHistory\",\"content\":821}}\nStep 3 Response: {{\"type\":\"Finish\",\"content\":\"User 821 likes Drama films with high ratings.\"}}\n\nFOR ITEM ANALYSIS:\nStep 1 Response: {{\"type\":\"ItemInfo\",\"content\":1311}}\nStep 2 Response: {{\"type\":\"ItemHistory\",\"content\":1311}}\nStep 3 Response: {{\"type\":\"Finish\",\"content\":\"Item 1311 is a Comedy-Drama film.\"}}\n\n=== ID MATCHING RULES ===\n✓ If analyzing 'user 821': use content:821 (number, not string)\n✓ If analyzing 'item 1311': use content:1311 (number, not string)\n✓ UserInfo/UserHistory use USER IDs\n✓ ItemInfo/ItemHistory use ITEM IDs\n✗ Don't mix user IDs and item IDs\n\n=== FINISH COMMAND RULES ===\n✓ Finish MUST have 2-3 sentences of analysis\n✓ Examples:\n  {{\"type\":\"Finish\",\"content\":\"User prefers Drama. Ratings average 4.5 stars. Dislikes Horror.\"}}\n  {{\"type\":\"Finish\",\"content\":\"Movie is 1995 Comedy-Drama. 3.8 star average rating. Appeals to adults.\"}}\n✗ Don't use: {{\"type\":\"Finish\",\"content\":\"done\"}}\n✗ Don't use: {{\"type\":\"Finish\",\"content\":\"User analysis complete\"}}\n\n=== WHAT TO GENERATE NOW ===\nGenerate ONLY ONE LINE of JSON. No explanations. No other text.\nJSON ONLY:\n"
    },
    "analyst_examples": {
        "type": "raw",
        "content": "EXAMPLE EXECUTION SEQUENCE:\nStep 1: UserInfo[821] → Get user profile\nStep 2: UserHistory[821] → Get user's movie watch history\nStep 3: Finish[User 821 is a 37-year-old engineer who prefers Drama and Crime films with ratings 4-5 stars]"
    },
    "analyst_examples_json": {
        "type": "raw",
        "content": "EXAMPLE EXECUTION SEQUENCE (JSON mode):\nStep 1: {{\"type\":\"UserInfo\",\"content\":821}} → Retrieve user demographics and profile\nStep 2: {{\"type\":\"UserHistory\",\"content\":821}} → Get interaction history with ratings\nStep 3: {{\"type\":\"Finish\",\"content\":\"User 821: age 37, engineer; prefers Drama(★★★★★), Crime(★★★★); dislikes Horror films\"}}"
    },
    "analyst_fewshot": {
        "type": "raw",
        "content": "Task: Analyze user 821\nExecution:\n  Query: UserInfo[821] → Found: Age 37, occupation: engineer\n  Query: UserHistory[821] → Found: Pulp Fiction (5★), Silence of Lambs (5★), Enchanted April (5★)\n  Result: User 821 strongly prefers Drama, Crime, Thriller genres (mostly 5-star ratings)\n\nTask: Analyze item 1311\nExecution:\n  Query: ItemInfo[1311] → Found: Waiting to Exhale, Comedy|Drama, 1995\n  Result: Item 1311 is a Drama-Comedy from 1995"
    },
    "analyst_fewshot_json": {
        "type": "raw",
        "content": "=== EXAMPLE 1: Analyzing a User ===\n\nTASK: Analyze user 821 for rating prediction\n\nSTEP 1: Get user info\n- I send: {{\"type\":\"UserInfo\",\"content\":821}}\n- Database returns: Age 37, male, engineer\n\nSTEP 2: Get user history  \n- I send: {{\"type\":\"UserHistory\",\"content\":821}}\n- Database returns: Watched Pulp Fiction(5★), Silence of Lambs(5★), Dances with Wolves(5★)\n\nSTEP 3: Finish analysis\n- I send: {{\"type\":\"Finish\",\"content\":\"User 821 is 37, engineer. Prefers Drama and Crime films. 5-star ratings. Dislikes Horror.\"}}\n- Analysis complete.\n\n---\n\n=== CLEAR EXAMPLE 2: Analyzing an Item ===\n\nTASK: Analyze item 1311 for ranking\n\nSTEP 1: Get item info\n- I send: {{\"type\":\"ItemInfo\",\"content\":1311}}\n- Database returns: Waiting to Exhale, 1995, Comedy|Drama\n\nSTEP 2: Get item history\n- I send: {{\"type\":\"ItemHistory\",\"content\":1311}}\n- Database returns: 25 users watched, average 3.8 stars\n\nSTEP 3: Finish analysis\n- I send: {{\"type\":\"Finish\",\"content\":\"Item 1311 is Comedy-Drama from 1995. 3.8 star average. Appeals to Comedy and Drama fans.\"}}\n- Analysis complete.\n\n---\n\n=== KEY POINTS ===\n✓ Use NUMBERS not strings: {{\"type\":\"UserInfo\",\"content\":821}} (not \"821\")\n✓ Each step uses DIFFERENT command: Step 1=UserInfo, Step 2=UserHistory (not same)\n✓ Finish has 2-3 sentences of analysis\n✓ ONLY JSON - no extra text before or after"
    },
    "analyst_hint": {
        "type": "raw",
        "content": "Key Tip: Always use 2-3 information gathering commands before Finish. Extract specific genre, rating, and user preference details."
    }
}
